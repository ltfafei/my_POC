#!/usr/bin/env python3
# -*- encoding: utf-8 -*-
#Author: afei

import requests
import time
import optparse

def main():
    usage='''Test_ClickJacking.py -u <url>'''
    parser=optparse.OptionParser(usage)
    parser.add_option('-u' , dest='url', help='Please input target URL!')
    (options,args)=parser.parse_args()
    if options.url:
        url=options.url
        jacking(url)
    else:
        parser.print_help()

def jacking(url):
    urls="{}".format(url)
    headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0 AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36'}
    request=requests.get(url=urls, headers=headers, timeout=5)
    if request.status_code == 200:
        print('[+]Target connect success!')
        print('')
        try:
            header=request.headers
            print(header['X-Frame-Options'])
            print('')
            print('[n]Set X-Frame-Options header, no clickjacking vulnerability can be used!')
        except:
            print('[+]There is no X-Frame-Options header, ClickJacking Vulnerability!!!')
            print('')
            print('Remind: It may be a defense JS, may be misinformation!!!  Please test it yourself')
    else:
        print('[n]Target connect instability!!!')

if __name__ == '__main__':
    main()